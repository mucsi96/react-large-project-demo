(this.webpackJsonpapp=this.webpackJsonpapp||[]).push([[0],{12:function(e,n,t){},13:function(e,n,t){},14:function(e,n,t){"use strict";t.r(n);var a=t(0),i=t.n(a),r=t(5),o=t.n(r),s=t(7),c=t.n(s),d=t(1);Object(d.a)(".Button-module_container__3PIsE {\n  vertical-align: top;\n  font-family: inherit;\n  padding: 10px 20px;\n  border: 1px solid white;\n  border-radius: 10px; }\n\n.Button-module_primary__pg7GC {\n  background-color: chocolate;\n  color: white; }\n\n.Button-module_secondary__2ce5v {\n  background-color: #cecece;\n  color: black; }\n\n.Button-module_disabled__1BllH {\n  opacity: 0.5; }\n");var l={container:"Button-module_container__3PIsE",primary:"Button-module_primary__pg7GC",secondary:"Button-module_secondary__2ce5v",disabled:"Button-module_disabled__1BllH"};const u=({children:e,disabled:n,primary:t,secondary:a,...r})=>i.a.createElement("button",Object.assign({},r,{type:"button",className:c()(l.container,{[l.primary]:t,[l.secondary]:a,[l.disabled]:n}),disabled:n}),e);Object(d.a)(".Spinner-module_container__5pI3h {\n  margin: 0 auto;\n  width: 50px;\n  height: 60px;\n  text-align: center;\n  font-size: 10px; }\n  .Spinner-module_container__5pI3h > * {\n    background-color: chocolate;\n    opacity: 0.5;\n    height: 100%;\n    width: 7px;\n    display: inline-block;\n    margin-right: 3px;\n    animation: Spinner-module_sk-stretchdelay__2FaZk 1.2s infinite ease-in-out; }\n  .Spinner-module_container__5pI3h :nth-child(2) {\n    animation-delay: -1.1s; }\n  .Spinner-module_container__5pI3h :nth-child(3) {\n    animation-delay: -1s; }\n  .Spinner-module_container__5pI3h :nth-child(4) {\n    animation-delay: -0.9s; }\n  .Spinner-module_container__5pI3h :nth-child(5) {\n    animation-delay: -0.8s; }\n\n@keyframes Spinner-module_sk-stretchdelay__2FaZk {\n  0%,\n  40%,\n  100% {\n    transform: scaleY(0.4); }\n  20% {\n    transform: scaleY(1); } }\n");var m={container:"Spinner-module_container__5pI3h","sk-stretchdelay":"Spinner-module_sk-stretchdelay__2FaZk"};const _=e=>i.a.createElement("div",Object.assign({},e,{className:m.container}),i.a.createElement("div",null),i.a.createElement("div",null),i.a.createElement("div",null),i.a.createElement("div",null),i.a.createElement("div",null));var f=t(6);Object(f.a)(".FriendsList-module_container__5BYRF {\n  display: grid;\n  gap: 30px;\n  max-width: 600px; }\n\n.FriendsList-module_friend__39Kzv {\n  text-decoration: initial;\n  color: initial;\n  display: grid;\n  font-size: 2em;\n  grid-template-columns: auto 1fr auto;\n  gap: 20px; }\n\n.FriendsList-module_actions__28cgA {\n  margin: 5px; }\n\n.FriendsList-module_notifications__1jk-d {\n  position: fixed;\n  bottom: 10px;\n  right: 10px; }\n\n.FriendsList-module_error__QzOml {\n  background-color: #c14f24;\n  padding: 10px 20px;\n  border: 1px solid white;\n  border-radius: 10px;\n  color: white; }\n\n.FriendsList-module_info__3M61P {\n  background-color: #5168abf2;\n  padding: 10px 20px;\n  border: 1px solid white;\n  border-radius: 10px;\n  color: white; }\n\n.FriendsList-module_loadMore__3ECMp {\n  text-align: center; }\n");var p,h={container:"FriendsList-module_container__5BYRF",friend:"FriendsList-module_friend__39Kzv",actions:"FriendsList-module_actions__28cgA",notifications:"FriendsList-module_notifications__1jk-d",error:"FriendsList-module_error__QzOml",info:"FriendsList-module_info__3M61P",loadMore:"FriendsList-module_loadMore__3ECMp"};function g(e,n,{cache:t,noAbortOnSubsequentCall:i}={}){const[r,o]=Object(a.useState)({isLoading:!1}),s=Object(a.useRef)(),c=Object(a.useRef)(!0);Object(a.useEffect)((()=>()=>{var e;c.current=!1,null===(e=s.current)||void 0===e||e.abort()}),[]);const d=Object(a.useCallback)((async(...a)=>{var r;i||null===(r=s.current)||void 0===r||r.abort();try{s.current=new AbortController,o({isLoading:!0});const i=await n((n=>{var a;return e({...n,cache:t,signal:null===(a=s.current)||void 0===a?void 0:a.signal})}),...a);o({isLoading:!1,data:i,fetchArgs:a})}catch(d){const e=d;"AbortError"!==e.name?o({isLoading:!1,error:e,fetchArgs:a}):c.current&&o({isLoading:!1,fetchArgs:a})}}),[n,s,e,t,i]),l=Object(a.useMemo)((()=>({})),[]);return Object.assign(l,r,{fetch:d})}async function E(e,{reference:n,searchText:t}={}){var a,i;return await e({href:null!==(i=null===(a=null===n||void 0===n?void 0:n._links.next)||void 0===a?void 0:a.href)&&void 0!==i?i:"/api/friends",...t&&{queryParams:{searchText:t}}})}async function v(e,{friend:n,action:t}){const{href:a,method:i}=n._links[t];await e({href:a,method:i})}function y(e,n,t){return{...e,friends:e.friends.map((e=>e.id!==n?e:{...e,...t}))}}function O(e,n){switch(n.type){case"LOAD_FRIENDS":return{...e,friends:[...e.friends,...n.payload._embedded]};case"ADD_TO_FAVORITES":return y(e,n.id,{isFavorite:!0,isProcessing:!0});case"REMOVE_FROM_FAVORITES":return y(e,n.id,{isFavorite:!1,isProcessing:!0});case"PROCESSING_SUCCEED":return y(e,n.friend.id,{isProcessing:!1});case"PROCESSING_FAILED":switch(n.action){case p.ADD_TO_FAVORITE:return{...y(e,n.friend.id,{isProcessing:!1,isFavorite:!1}),notifications:[{key:n.notificationKey,message:`Adding ${n.friend.firstName} to favorite was not successful`},...e.notifications]};case p.REMOVE_FROM_FAVORITE:return{...y(e,n.friend.id,{isProcessing:!1,isFavorite:!0}),notifications:[{key:n.notificationKey,message:`Removing ${n.friend.firstName} from favorite was not successful`},...e.notifications]};default:return e}case"CLEAR_NOTIFICATION":return{...e,notifications:e.notifications.filter((({key:e})=>e!==n.key))};case"SEARCH":return{...e,searchText:n.text,friends:[]};default:return e}}!function(e){e.ADD_TO_FAVORITE="addToFavorite",e.REMOVE_FROM_FAVORITE="removeFromFavorite"}(p||(p={}));const b=({callApi:e})=>{const{friends:n=[],isLoading:t,isEmpty:r,loadingErrorMessage:o,searchText:s,loadMore:c,addToFavorites:d,removeFromFavorites:l,notifications:m,search:f}=function(e){var n,t,i,r;const o=g(e,E),s=g(e,v,{noAbortOnSubsequentCall:!0}),[c,d]=Object(a.useReducer)(O,{friends:[],notifications:[],searchText:""});return Object(a.useEffect)((()=>{o.fetch({searchText:c.searchText})}),[o,c.searchText]),Object(a.useEffect)((()=>{o.data&&d({type:"LOAD_FRIENDS",payload:o.data})}),[o.data]),Object(a.useEffect)((()=>{if(!s.fetchArgs)return;const[{friend:e,action:n}]=s.fetchArgs,t=Date.now().toString();d({type:s.error?"PROCESSING_FAILED":"PROCESSING_SUCCEED",friend:e,action:n,notificationKey:t}),setTimeout((()=>d({type:"CLEAR_NOTIFICATION",key:t})),3e3)}),[s.data,s.error,s.fetchArgs]),{friends:c.friends,isLoading:o.isLoading,isEmpty:!!o.data&&!c.friends.length,loadingErrorMessage:o.error&&`${null!==(i=null===(t=null===(n=o.error.response)||void 0===n?void 0:n.error)||void 0===t?void 0:t.message)&&void 0!==i?i:""} Status: ${null!==(r=o.error.status)&&void 0!==r?r:""}`,searchText:c.searchText,loadMore:o.data&&(l=o.data,l._links.next)?()=>o.fetch({reference:o.data,searchText:c.searchText}):void 0,addToFavorites:e=>{d({type:"ADD_TO_FAVORITES",id:e.id}),s.fetch({friend:e,action:p.ADD_TO_FAVORITE})},removeFromFavorites:e=>{d({type:"REMOVE_FROM_FAVORITES",id:e.id}),s.fetch({friend:e,action:p.REMOVE_FROM_FAVORITE})},notifications:c.notifications,search:e=>d({type:"SEARCH",text:e})};var l}(e);return i.a.createElement("div",{"data-name":"friend-list",className:h.container},i.a.createElement("input",{type:"text",value:s,onChange:e=>f(e.target.value)}),!!m.length&&i.a.createElement("div",{"data-name":"notifications",className:h.notifications},m.map((({key:e,message:n})=>i.a.createElement("p",{key:e,className:h.error},n)))),n.map((e=>{const{id:n,firstName:t,lastName:a,image:r}=e,o=[t,a].join(" ");return i.a.createElement("div",{key:n,"data-name":"friend",className:h.friend},i.a.createElement("img",{src:r,alt:o}),i.a.createElement("span",{"data-name":"full-name"},o),i.a.createElement("div",{className:h.actions},!e.isFavorite&&i.a.createElement(u,{primary:!0,onClick:()=>d(e),"data-name":"add-to-favorite",disabled:e.isProcessing},"Add to favorite"),e.isFavorite&&i.a.createElement(u,{secondary:!0,onClick:()=>l(e),"data-name":"remove-from-favorite",disabled:e.isProcessing},"Remove from favorite")))})),t?i.a.createElement(_,null):o?i.a.createElement("span",{"data-name":"message",className:h.error},o):r?i.a.createElement("span",{"data-name":"message",className:h.info},"No friends found :("):c?i.a.createElement("div",{className:h.loadMore},i.a.createElement(u,{secondary:!0,onClick:c,"data-name":"load-more"},"Load more...")):void 0)};async function F({href:e,queryParams:n={},method:t,headers:a,body:i,signal:r}){const o=Object.entries(n).reduce(((e,[n,t])=>(e.set(n,t),e)),new URLSearchParams).toString(),s=e.includes("?")?"&":"?",c=await window.fetch([e,o].filter(Boolean).join(s),{...t&&{method:t},headers:{...a,"Content-Type":"application/json"},...i?{body:JSON.stringify(i)}:{},...r&&{signal:r}}),d=await c.text(),l=d?JSON.parse(d):null;if(!c.ok)throw{message:"Failed to fetch data",response:l,status:c.status};return l}t(12);var x=()=>i.a.createElement(b,{callApi:F});t(13);o.a.render(i.a.createElement(i.a.StrictMode,null,i.a.createElement(x,null)),document.getElementById("root"))}},[[14,1,2]]]);
//# sourceMappingURL=main.d3a2bb00.chunk.js.map