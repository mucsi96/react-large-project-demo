(this.webpackJsonpapp=this.webpackJsonpapp||[]).push([[0],{12:function(e,n,t){},13:function(e,n,t){},14:function(e,n,t){"use strict";t.r(n);var a=t(0),i=t.n(a),r=t(5),o=t.n(r),s=t(7),d=t.n(s),c=t(1);Object(c.a)(".Button-module_container__3PIsE {\n  vertical-align: top;\n  font-family: inherit;\n  padding: 10px 20px;\n  border: 1px solid white;\n  border-radius: 10px; }\n\n.Button-module_primary__pg7GC {\n  background-color: chocolate;\n  color: white; }\n\n.Button-module_secondary__2ce5v {\n  background-color: #cecece;\n  color: black; }\n\n.Button-module_disabled__1BllH {\n  opacity: 0.5; }\n");var l={container:"Button-module_container__3PIsE",primary:"Button-module_primary__pg7GC",secondary:"Button-module_secondary__2ce5v",disabled:"Button-module_disabled__1BllH"};const m=({children:e,disabled:n,primary:t,secondary:a,...r})=>i.a.createElement("button",Object.assign({},r,{type:"button",className:d()(l.container,{[l.primary]:t,[l.secondary]:a,[l.disabled]:n}),disabled:n}),e);Object(c.a)(".Spinner-module_container__5pI3h {\n  margin: 0 auto;\n  width: 50px;\n  height: 60px;\n  text-align: center;\n  font-size: 10px; }\n  .Spinner-module_container__5pI3h > * {\n    background-color: chocolate;\n    opacity: 0.5;\n    height: 100%;\n    width: 7px;\n    display: inline-block;\n    margin-right: 3px;\n    animation: Spinner-module_sk-stretchdelay__2FaZk 1.2s infinite ease-in-out; }\n  .Spinner-module_container__5pI3h :nth-child(2) {\n    animation-delay: -1.1s; }\n  .Spinner-module_container__5pI3h :nth-child(3) {\n    animation-delay: -1s; }\n  .Spinner-module_container__5pI3h :nth-child(4) {\n    animation-delay: -0.9s; }\n  .Spinner-module_container__5pI3h :nth-child(5) {\n    animation-delay: -0.8s; }\n\n@keyframes Spinner-module_sk-stretchdelay__2FaZk {\n  0%,\n  40%,\n  100% {\n    transform: scaleY(0.4); }\n  20% {\n    transform: scaleY(1); } }\n");var u={container:"Spinner-module_container__5pI3h","sk-stretchdelay":"Spinner-module_sk-stretchdelay__2FaZk"};const _=e=>i.a.createElement("div",Object.assign({},e,{className:u.container}),i.a.createElement("div",null),i.a.createElement("div",null),i.a.createElement("div",null),i.a.createElement("div",null),i.a.createElement("div",null));var f=t(6);Object(f.a)(".FriendsList-module_container__5BYRF {\n  display: grid;\n  gap: 30px;\n  max-width: 600px; }\n\n.FriendsList-module_friend__39Kzv {\n  text-decoration: initial;\n  color: initial;\n  display: grid;\n  font-size: 2em;\n  grid-template-columns: auto 1fr auto;\n  gap: 20px; }\n\n.FriendsList-module_actions__28cgA {\n  margin: 5px; }\n\n.FriendsList-module_notifications__1jk-d {\n  position: fixed;\n  bottom: 10px;\n  right: 10px; }\n\n.FriendsList-module_error__QzOml {\n  background-color: #c14f24;\n  padding: 10px 20px;\n  border: 1px solid white;\n  border-radius: 10px;\n  color: white; }\n\n.FriendsList-module_info__3M61P {\n  background-color: #5168abf2;\n  padding: 10px 20px;\n  border: 1px solid white;\n  border-radius: 10px;\n  color: white; }\n\n.FriendsList-module_loadMore__3ECMp {\n  text-align: center; }\n");var p,g={container:"FriendsList-module_container__5BYRF",friend:"FriendsList-module_friend__39Kzv",actions:"FriendsList-module_actions__28cgA",notifications:"FriendsList-module_notifications__1jk-d",error:"FriendsList-module_error__QzOml",info:"FriendsList-module_info__3M61P",loadMore:"FriendsList-module_loadMore__3ECMp"};function h(e,n,{cache:t,noAbortOnSubsequentCall:i}={}){const[r,o]=Object(a.useState)({isLoading:!1}),s=Object(a.useRef)();Object(a.useEffect)((()=>()=>{var e;return null===(e=s.current)||void 0===e?void 0:e.abort()}),[]);const d=Object(a.useCallback)((async(...a)=>{var r;i||null===(r=s.current)||void 0===r||r.abort();try{s.current=new AbortController,o({isLoading:!0});const i=await n((n=>{var a;return e({...n,cache:t,signal:null===(a=s.current)||void 0===a?void 0:a.signal})}),...a);o({isLoading:!1,data:i,fetchArgs:a})}catch(d){const e=d;"AbortError"!==e.name?o({isLoading:!1,error:e,fetchArgs:a}):o({isLoading:!1,fetchArgs:a})}}),[n,s,e,t,i]),c=Object(a.useMemo)((()=>({})),[]);return Object.assign(c,r,{fetch:d})}async function E(e,n){var t,a;return await e({href:null!==(a=null===(t=null===n||void 0===n?void 0:n._links.next)||void 0===t?void 0:t.href)&&void 0!==a?a:"/api/friends"})}async function v(e,n,t){const{href:a,method:i}=n._links[t];await e({href:a,method:i})}function y(e,n,t){return{...e,friends:e.friends.map((e=>e.id!==n?e:{...e,...t}))}}function F(e,n){switch(n.type){case"LOAD_FRIENDS":return{...e,friends:[...e.friends,...n.payload._embedded]};case"ADD_TO_FAVORITES":return y(e,n.id,{isFavorite:!0,isProcessing:!0});case"REMOVE_FROM_FAVORITES":return y(e,n.id,{isFavorite:!1,isProcessing:!0});case"PROCESSING_SUCCEED":return y(e,n.friend.id,{isProcessing:!1});case"PROCESSING_FAILED":switch(n.action){case p.ADD_TO_FAVORITE:return{...y(e,n.friend.id,{isProcessing:!1,isFavorite:!1}),notifications:[{key:n.notificationKey,message:`Adding ${n.friend.firstName} to favorite was not successful`},...e.notifications]};case p.REMOVE_FROM_FAVORITE:return{...y(e,n.friend.id,{isProcessing:!1,isFavorite:!0}),notifications:[{key:n.notificationKey,message:`Removing ${n.friend.firstName} from favorite was not successful`},...e.notifications]};default:return e}case"CLEAR_NOTIFICATION":return{...e,notifications:e.notifications.filter((({key:e})=>e!==n.key))};default:return e}}!function(e){e.ADD_TO_FAVORITE="addToFavorite",e.REMOVE_FROM_FAVORITE="removeFromFavorite"}(p||(p={}));const O=({callApi:e})=>{const{friends:n=[],isLoading:t,isEmpty:r,loadingErrorMessage:o,loadMore:s,addToFavorites:d,removeFromFavorites:c,notifications:l}=function(e){var n,t,i,r;const o=h(e,E),s=h(e,v,{noAbortOnSubsequentCall:!0}),[d,c]=Object(a.useReducer)(F,{friends:[],notifications:[]});return Object(a.useEffect)((()=>{o.fetch()}),[o]),Object(a.useEffect)((()=>{o.data&&c({type:"LOAD_FRIENDS",payload:o.data})}),[o.data]),Object(a.useEffect)((()=>{if(!s.fetchArgs)return;const[e,n]=s.fetchArgs,t=Date.now().toString();c({type:s.error?"PROCESSING_FAILED":"PROCESSING_SUCCEED",friend:e,action:n,notificationKey:t}),setTimeout((()=>c({type:"CLEAR_NOTIFICATION",key:t})),3e3)}),[s.data,s.error,s.fetchArgs]),{friends:d.friends,isLoading:o.isLoading,isEmpty:!!o.data&&!d.friends.length,loadingErrorMessage:o.error&&`${null!==(i=null===(t=null===(n=o.error.response)||void 0===n?void 0:n.error)||void 0===t?void 0:t.message)&&void 0!==i?i:""} Status: ${null!==(r=o.error.status)&&void 0!==r?r:""}`,loadMore:o.data&&(l=o.data,l._links.next)?()=>o.fetch(o.data):void 0,addToFavorites:e=>{c({type:"ADD_TO_FAVORITES",id:e.id}),s.fetch(e,p.ADD_TO_FAVORITE)},removeFromFavorites:e=>{c({type:"REMOVE_FROM_FAVORITES",id:e.id}),s.fetch(e,p.REMOVE_FROM_FAVORITE)},notifications:d.notifications};var l}(e);return i.a.createElement("div",{"data-name":"friend-list",className:g.container},!!l.length&&i.a.createElement("div",{"data-name":"notifications",className:g.notifications},l.map((({key:e,message:n})=>i.a.createElement("p",{key:e,className:g.error},n)))),n.map((e=>{const{id:n,firstName:t,lastName:a,image:r}=e,o=[t,a].join(" ");return i.a.createElement("div",{key:n,"data-name":"friend",className:g.friend},i.a.createElement("img",{src:r,alt:o}),i.a.createElement("span",{"data-name":"full-name"},o),i.a.createElement("div",{className:g.actions},!e.isFavorite&&i.a.createElement(m,{primary:!0,onClick:()=>d(e),"data-name":"add-to-favorite",disabled:e.isProcessing},"Add to favorite"),e.isFavorite&&i.a.createElement(m,{secondary:!0,onClick:()=>c(e),"data-name":"remove-from-favorite",disabled:e.isProcessing},"Remove from favorite")))})),t?i.a.createElement(_,null):o?i.a.createElement("span",{"data-name":"message",className:g.error},o):r?i.a.createElement("span",{"data-name":"message",className:g.info},"No friends found :("):s?i.a.createElement("div",{className:g.loadMore},i.a.createElement(m,{secondary:!0,onClick:s,"data-name":"load-more"},"Load more...")):void 0)};async function b({href:e,method:n,headers:t,body:a,signal:i}){const r=await window.fetch(e,{...n&&{method:n},headers:{...t,"Content-Type":"application/json"},...a?{body:JSON.stringify(a)}:{},...i&&{signal:i}}),o=await r.text(),s=o?JSON.parse(o):null;if(!r.ok)throw{message:"Failed to fetch data",response:s,status:r.status};return s}t(12);var A=()=>i.a.createElement(O,{callApi:b});t(13);o.a.render(i.a.createElement(i.a.StrictMode,null,i.a.createElement(A,null)),document.getElementById("root"))}},[[14,1,2]]]);
//# sourceMappingURL=main.a669923c.chunk.js.map